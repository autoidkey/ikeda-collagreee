<div class="panel panel-default">
  <div class="panel-body">
    <h3>Point / ポイントデバッグ</h3>
    <span id="">あなたの議論ポイントは</span>
    <span id="sum_point">  <%= current_user.sum_point(@theme) %></span>
    <span id="">ポイントです</span>

    <table class="table">
      <thead>
        <tr>
          <th>投稿</th>
          <th>返信</th>
          <th>Like</th>
          <th>アクティブポイント</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td id="entry_point"><%= current_user.entry_point(@theme) %></td>
          <td id="reply_point"><%= current_user.reply_point(@theme) %></td>
          <td id="like_point"><%= current_user.like_point(@theme) %></td>
          <td id="active_point"><%= current_user.active_point(@theme) %></td>
        </tr>
      </tbody>
    </table>
    <table class="table">
      <thead>
        <tr>
          <th>返信された</th>
          <th>Likeされた</th>
          <th></th>
          <th>パッシブポイント</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td id="replied_point"><%= current_user.replied_point(@theme) %></td>
          <td id="liked_point"><%= current_user.liked_point(@theme) %></td>
          <td></td>
          <td id="passive_point"><%= current_user.passive_point(@theme) %></td>
        </tr>
      </tbody>
    </table>

    <h4>ポイント履歴</h4>
    <div style="max-height:300px; overflow-y:scroll;">
      <table height="" class="table">
        <thead>
          <tr>
          </tr>
        </thead>
        <tbody>
          <% current_user.point_history(@theme).each do |ap| %>
            <tr>
              <td>
                $<%= ap.point %>
                <% case ap.action
                   when "投稿" %>
                投稿しました (投稿 No.<%= ap.entry.id %>)
                <% when "返信" %>
                <%= ap.entry.parent.user.name %>さんの投稿に返信しました (投稿 No.<%= ap.entry.id %>)
                <% when "Like" %>
                <%= ap.entry.user.name %>さんの投稿にLikeしました (Like No.<%= ap.like.id %>)
                <% when "返信され" %>
                <%= ap.reply.user.name if ap.reply.present? %>さんに返信されました (投稿 No.<%= ap.entry.id %>)
                <% when "Likeされ" %>
                <% if ap.depth == 0 %>
                  投稿(No.<%= ap.entry.id %>)が<%= ap.like.user.name %>さんにLikeされました (Like No.<%= ap.like.id %>)
                <% else %>
                  投稿(No.<%= ap.entry.id %>)に関連する投稿が<%= ap.like.user.name %>さんにLikeされました (Like No.<%= ap.like.id %>)
                <% end %>
                <% when "Likeを削除され" %>
                投稿(No.<%= ap.entry.id %>)への<%= ap.like.user.name %>さんのLikeが削除されました (Like No.<%= ap.like.id %>)
          <% end %>
</td>
</tr>
<% end %>
</tbody>
</table>
</div>
</div>
</div>
